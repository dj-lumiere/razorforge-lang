import system/console/show_line
redefinition A as B

# Entities, Records, Menus, and Variants in Suflae

# Entity Example - Reference type with inheritance
entity Animal:
    public(family) var species: Text
    @[public get, private set]
    var name: Text

    public routine __create__(name: Text, species: Text) -> Animal:
        me.name = name
        me.species = species
        return me

    public routine speak() -> Text:
        return f"{me.name} makes a sound"

entity Dog from Animal:
    public var breed: Text

    public routine __create__(name: Text, breed: Text) -> Dog:
        parent(name, "Canine")
        me.breed = breed
        return me

    public routine speak() -> Text:
        return f"{me.name} barks: Woof!"

# Record Example - Value type for data
record Point:
    public var x: Decimal
    public var y: Decimal

    public routine distance_from_origin() -> Decimal:
        return (me.x * me.x + me.y * me.y).sqrt()

    public routine translate(dx: Decimal, dy: Decimal) -> Point:
        return Point(x: me.x + dx, y: me.y + dy)

# Choice (Enum) Example - Simple enumeration
choice Color:
    Red
    Green
    Blue

    public routine to_hex() -> Text:
        when me:
            Color.Red => return "#FF0000"
            Color.Green => return "#00FF00"
            Color.Blue => return "#0000FF"

# Chimera Example - Tagged union
chimera Result<T>:
    Success(T)
    Error(Error)

    public routine unwrap() -> T:
        when me:
            is Crashable error: throw TypeMismatchError(f"Unwrap failed: {error}")
            else _: return _

    public routine is_success() -> Bool:
        when me:
            is Crashable _: return false
            _: return true

chimera Maybe<T>:
    Valid(T)
    Invalid

    # This will be overridden as ?: operator.
    public routine unwrap_or(default: T) -> T:
        when me:
            is Invalid: return default
            _: return _

# Feature Example - Interface/trait
feature Drawable:
    routine draw() -> Text

# Implementing feature for a record
record Circle:
    public var radius: Decimal
    public var center: Point

    public routine area() -> Decimal:
        return 3.14159 * me.radius * me.radius

# Making Circle drawable
Circle follows Drawable:
    routine draw() -> Text:
        return f"Circle at ({me.center.x}, {me.center.y}) with radius {me.radius}"

# Usage example
routine main():
    # Entity usage
    var dog = Dog("Buddy", "Golden Retriever")
    show_line(dog.speak())

    # Record usage
    var point = Point(x: 3.0, y: 4.0)
    var distance = point.distance_from_origin()
    show_line(f"Distance: {distance}")

    # Option usage
    var color = Color.Red
    show_line(f"Color: {color.to_hex()}")


    when success:
        is Error error: show_line(f"Error: {error}")
        _: show_line(f"Got value: {_}")

    # Feature usage
    var circle = Circle(radius: 5.0, center: Point(x: 0.0, y: 0.0))
    show_line(circle.draw())

    for i in 1 to 10 step 2:
        show_line(i)

    var t8 = t8"aa"
    var t16 = t16"aa"
    var t32 = "aa"
    var t322 = t32"aa"
    var l8 = l8'\''
    var l16 = l16'a'
    var l32 = 'a'
